    <div class="premium-stat-card iqa-card {% if latest and latest.iqa != None %}{% if latest.iqa <= 50 %}iqa-good{% elif latest.iqa <= 100 %}iqa-moderate{% elif latest.iqa <= 150 %}iqa-unhealthy{% else %}iqa-hazardous{% endif %}{% else %}iqa-unknown{% endif %}" id="card-iqa" style="grid-column: span 2; padding: 2rem;">
      <div class="stat-icon" style="background: rgba(255, 255, 255, 0.2); color: white; width: 60px; height: 60px; font-size: 2rem;">
        <i class="fas fa-leaf"></i>
      </div>
      <div class="stat-content" style="text-align: right;">
        <div class="stat-label" style="color: rgba(255, 255, 255, 0.9); font-size: 0.9rem;">Indice IQA</div>
        <div class="stat-value" id="val-iqa" style="color: white; font-size: 3.5rem; font-weight: 800;">{{ latest.iqa|default:"-" }}</div>
        <div id="iqa-status" style="font-size: 1rem; font-weight: 600; color: white; margin-top: 0.25rem;">
          {% if latest and latest.iqa != None %}
            {% if latest.iqa <= 50 %}BON - Air sain{% elif latest.iqa <= 100 %}MODÉRÉ - Attention{% elif latest.iqa <= 150 %}MAUVAIS - Sensible{% else %}DANGER - Alerte{% endif %}
          {% else %}
            Données insuffisantes
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Pollutants Grid -->
    <div class="premium-stat-card">
      <div class="stat-icon" style="background: rgba(16, 185, 129, 0.1); color: var(--primary);">
        <i class="fas fa-cloud"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="val-no2">{{ latest.no2|floatformat:1|default:"-" }}</div>
        <div class="stat-label">NO2 (µg/m³)</div>
        <small style="color: var(--gray); font-size: 0.65rem; display: block; margin-top: 2px;">Dioxyde d'azote</small>
      </div>
    </div>

    <div class="premium-stat-card">
      <div class="stat-icon" style="background: rgba(59, 130, 246, 0.1); color: var(--secondary);">
        <i class="fas fa-smog"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="val-so2" style="color: var(--secondary);">{{ latest.so2|floatformat:1|default:"-" }}</div>
        <div class="stat-label">SO2 (µg/m³)</div>
        <small style="color: var(--gray); font-size: 0.65rem; display: block; margin-top: 2px;">Dioxyde de soufre</small>
      </div>
    </div>

    <div class="premium-stat-card">
      <div class="stat-icon" style="background: rgba(245, 158, 11, 0.1); color: var(--warning);">
        <i class="fas fa-wind"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="val-o3" style="color: var(--warning);">{{ latest.o3|floatformat:1|default:"-" }}</div>
        <div class="stat-label">O3 (µg/m³)</div>
        <small style="color: var(--gray); font-size: 0.65rem; display: block; margin-top: 2px;">Ozone</small>
      </div>
    </div>

    <div class="premium-stat-card">
      <div class="stat-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">
        <i class="fas fa-atom"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="val-pm25" style="color: #8b5cf6;">{{ latest.pm25|floatformat:1|default:"-" }}</div>
        <div class="stat-label">PM2.5 (µg/m³)</div>
        <small style="color: var(--gray); font-size: 0.65rem; display: block; margin-top: 2px;">Particules</small>
      </div>
    </div>

    <div class="premium-stat-card">
      <div class="stat-icon" style="background: rgba(239, 68, 68, 0.1); color: var(--danger);">
        <i class="fas fa-burn"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="val-co" style="color: var(--danger);">{{ latest.co|floatformat:2|default:"-" }}</div>
        <div class="stat-label">CO (µg/m³)</div>
        <small style="color: var(--gray); font-size: 0.65rem; display: block; margin-top: 2px;">Monoxyde carbone</small>
      </div>
    </div>

    <div class="premium-stat-card">
      <div class="stat-icon" style="background: rgba(59, 130, 246, 0.1); color: #3b82f6;">
        <i class="fas fa-thermometer-half"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="val-temp" style="color: #3b82f6;">{{ latest.temperature|floatformat:1|default:"-" }}</div>
        <div class="stat-label">Temp °C</div>
        <small style="color: var(--gray); font-size: 0.65rem; display: block; margin-top: 2px;">Température</small>
      </div>
    </div>

    <div class="premium-stat-card">
      <div class="stat-icon" style="background: rgba(6, 182, 212, 0.1); color: #06b6d4;">
        <i class="fas fa-tint"></i>
      </div>
      <div class="stat-content">
        <div class="stat-value" id="val-hum" style="color: #06b6d4;">{{ latest.humidity|floatformat:1|default:"-" }}</div>
        <div class="stat-label">Humidité %</div>
        <small style="color: var(--gray); font-size: 0.65rem; display: block; margin-top: 2px;">Relat. de l'air</small>
      </div>
    </div>

    <div class="premium-stat-card" style="grid-column: span 1; background: var(--section-bg-light); border-style: dashed;">
      <div class="stat-icon" style="background: rgba(107, 114, 128, 0.1); color: var(--gray);">
        <i class="fas fa-info-circle"></i>
      </div>
      <div class="stat-content">
        <div class="stat-label">Source de données</div>
        <div class="stat-value" id="val-source" style="font-size: 1.1rem; color: var(--text-color);">{{ latest.get_source_type_display }}</div>
        <small style="color: var(--gray); font-size: 0.65rem;">ID: {{ latest.source_id|default:"Inconnu" }}</small>
      </div>
    </div>
</div>
<!-- Hidden data for Charts update (processed by client-side JS) -->
<script>
    if (typeof updateChart === 'function') {
        // Trigger chart updates with new data... this part is tricky with pure HTMX replacement.
        // For now, let's keep the visual refresh. Full chart update via HTMX would require returning JSON or a script.
        // We will trigger a custom event or let the existing polling handle charts for now to keep it simple as per request.
    }
</script>
